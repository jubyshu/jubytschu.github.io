<section class="post-comments">
  <div id="disqus_thread"></div>
  <script src="//{{ site.cdn }}/npm/disqusjs@1.3/dist/disqus.js"></script>
  <script>
	  function loadDisqus() {
	    const dsqjs = new DisqusJS({
		    shortname: '{{ site.disqus.shortname }}',
		    siteName: '{{ site.disqus.sitename }}',
		    identifier: window.location.href.substring(18),
		    url: window.location.href,
		    // title: '',
		    // api: '',
		    apikey: '{{ site.disqus.apikey }}',
		    admin: '{{ site.disqus.admin }}',
		    adminLabel: '{{ site.disqus.mod }}',
		    nocomment: '{{ site.disqus.nocomment }}'
	  	});
	  }

		let runningOnBrowser = typeof window !== "undefined";
		let isBot = runningOnBrowser && !("onscroll" in window) || typeof navigator !== "undefined" && /(gle|ing|ro|msn)bot|crawl|spider|yand|duckgo/i.test(navigator.userAgent);
		let supportsIntersectionObserver = runningOnBrowser && "IntersectionObserver" in window;

		setTimeout(function () {
		  if (!isBot && supportsIntersectionObserver) {
		    let disqus_observer = new IntersectionObserver(function(entries) {
		      if (entries[0].isIntersecting) {
		        loadDisqus();
		        disqus_observer.disconnect();
		      }
		    }, { threshold: [0] });
		    disqus_observer.observe(document.getElementById('disqus_thread'));
		  } else {
		    loadDisqus();
		  }
		}, 1);
  </script>
</section>